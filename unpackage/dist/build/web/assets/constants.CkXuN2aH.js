import{H as o,a4 as e,r as t}from"./index-DwnOT4K7.js";import{r as n}from"./request.DtiC9qg0.js";const s={addGoods:o=>n.post("/trade/addGoods",o),updGoods:o=>n.post("/trade/updGoods",o),delGoods:o=>n.delete(`/trade/delGoods/${o}`),queryGoods:o=>n.post("/trade/queryGoods",o),queryLog:o=>n.post("/trade/queryLog",o),queryProfit:o=>n.post("/trade/queryProfit",o),addLog:async e=>{let t;console.log("新建日志API被调用，参数:",e),console.log("传入的id:",e.id),console.log("传入的inDesc:",e.inDesc),console.log("传入的inPrice:",e.inPrice),console.log("传入的isRise:",e.isRise),console.log("传入的count:",e.count),console.log("传入的addInImgs:",e.addInImgs?"有入场图片文件":"无入场图片文件");let n="application/json";try{if("undefined"!=typeof FormData){if(t=new FormData,t.append("id",e.id),t.append("inDesc",e.inDesc),t.append("inPrice",e.inPrice),t.append("isRise",e.isRise),t.append("count",e.count),e.addInImgs&&e.addInImgs.length>0){console.log("检测到入场图片文件:",e.addInImgs.length,"张");for(let o=0;o<e.addInImgs.length;o++){const n=e.addInImgs[o];console.log("处理入场图片",o,":",typeof n,n instanceof File?"是File对象":n instanceof Blob?"是Blob对象":"其他类型"),n instanceof File||n instanceof Blob?(console.log("添加入场图片文件到FormData, 文件名:",n.name||"未命名文件","大小:",n.size,"bytes"),t.append("addInImgs",n,n.name||`inImg_${Date.now()}_${o}.jpg`)):console.error("入场图片不是文件对象:",typeof n)}}console.log("FormData包含的字段:");for(let o of t.entries())console.log(o[0],o[1]instanceof File?"是File对象":typeof o[1]);n="multipart/form-data"}else console.warn("FormData不可用，使用JSON格式发送请求"),t=JSON.stringify({id:e.id,inDesc:e.inDesc,inPrice:e.inPrice,isRise:e.isRise,count:e.count})}catch(a){console.warn("FormData创建失败，使用JSON格式:",a),t=JSON.stringify({id:e.id,inDesc:e.inDesc,inPrice:e.inPrice,isRise:e.isRise,count:e.count})}let s="";try{const e=o("userInfo");if(e){s=("string"==typeof e?JSON.parse(e):e).authorization||""}}catch(r){console.error("获取token失败:",r),s=""}console.log("准备发送请求, URL:","http://192.168.199.113:9999/trade/addLog");try{console.log("H5环境，使用fetch上传");const o=new FormData;if("application/json"===n){const e=JSON.parse(t);Object.keys(e).forEach((t=>{o.append(t,e[t])}))}const e=await fetch("http://192.168.199.113:9999/trade/addLog",{method:"POST",headers:{Authorization:s?`Bearer ${s}`:""},body:"application/json"===n?o:t});if(!e.ok){const o=await e.text();throw console.error("API请求失败:",e.status,o),new Error(`HTTP error! status: ${e.status}`)}const a=await e.json();if(console.log("API请求成功，返回结果:",a),200==a.code||"200"==a.code)return a;throw new Error(a.msg||a.message||"创建失败")}catch(r){throw console.error("API请求异常:",r),r}},updLog:async e=>{let t;console.log("更新日志API被调用，参数:",e),console.log("传入的id:",e.id),console.log("传入的inDesc:",e.inDesc),console.log("传入的inPrice:",e.inPrice),console.log("传入的isRise:",e.isRise),console.log("传入的count:",e.count),console.log("传入的inImgs:",e.inImgs||"无已有图片"),console.log("传入的addInImgs:",e.addInImgs?"有入场图片文件":"无入场图片文件");let n="application/json";try{if("undefined"!=typeof FormData){if(t=new FormData,t.append("id",e.id),t.append("inDesc",e.inDesc),t.append("inPrice",e.inPrice),t.append("isRise",e.isRise),t.append("count",e.count),e.inImgs&&(t.append("inImgs",e.inImgs),console.log("添加已有图片JSON字符串到FormData:",e.inImgs)),e.addInImgs&&e.addInImgs.length>0){console.log("检测到入场图片文件:",e.addInImgs.length,"张");for(let o=0;o<e.addInImgs.length;o++){const n=e.addInImgs[o];console.log("处理入场图片",o,":",typeof n,n instanceof File?"是File对象":n instanceof Blob?"是Blob对象":"其他类型"),n instanceof File||n instanceof Blob?(console.log("添加入场图片文件到FormData, 文件名:",n.name||"未命名文件","大小:",n.size,"bytes"),t.append("addInImgs",n,n.name||`inImg_${Date.now()}_${o}.jpg`)):console.error("入场图片不是文件对象:",typeof n)}}console.log("FormData包含的字段:");for(let o of t.entries())console.log(o[0],o[1]instanceof File?"是File对象":typeof o[1]);n="multipart/form-data"}else console.warn("FormData不可用，使用JSON格式发送请求"),t=JSON.stringify({id:e.id,inDesc:e.inDesc,inPrice:e.inPrice,isRise:e.isRise,count:e.count,inImgs:e.inImgs||""})}catch(a){console.warn("FormData创建失败，使用JSON格式:",a),t=JSON.stringify({id:e.id,inDesc:e.inDesc,inPrice:e.inPrice,isRise:e.isRise,count:e.count,inImgs:e.inImgs||""})}let s="";try{const e=o("userInfo");if(e){s=("string"==typeof e?JSON.parse(e):e).authorization||""}}catch(r){console.error("获取token失败:",r),s=""}console.log("准备发送请求, URL:","http://192.168.199.113:9999/trade/updLog");try{console.log("H5环境，使用fetch上传");const o=new FormData;if("application/json"===n){const e=JSON.parse(t);Object.keys(e).forEach((t=>{o.append(t,e[t])}))}const e=await fetch("http://192.168.199.113:9999/trade/updLog",{method:"POST",headers:{Authorization:s?`Bearer ${s}`:""},body:"application/json"===n?o:t});if(!e.ok){const o=await e.text();throw console.error("API请求失败:",e.status,o),new Error(`HTTP error! status: ${e.status}`)}const a=await e.json();if(console.log("API请求成功，返回结果:",a),200==a.code||"200"==a.code)return a;throw new Error(a.msg||a.message||"更新失败")}catch(r){throw console.error("API请求异常:",r),r}},delLog:o=>n.delete(`/trade/delLog/${o}`),queryOutLog:o=>n.get(`/trade/queryOutLog/${o}`),addOutLog:async e=>{let t;console.log("新建出场日志API被调用，参数:",e),console.log("传入的tradeLogId:",e.tradeLogId),console.log("传入的count:",e.count),console.log("传入的outDesc:",e.outDesc),console.log("传入的outPrice:",e.outPrice),console.log("传入的outImgs:",e.outImgs||"无已有图片"),console.log("传入的addOutImgs:",e.addOutImgs?"有出场图片文件":"无出场图片文件");let n="application/json";try{if("undefined"!=typeof FormData){if(t=new FormData,t.append("tradeLogId",e.tradeLogId),t.append("count",e.count),t.append("outDesc",e.outDesc||""),t.append("outPrice",e.outPrice),e.outImgs&&(t.append("outImgs",e.outImgs),console.log("添加已有出场图片JSON字符串到FormData:",e.outImgs)),e.addOutImgs&&e.addOutImgs.length>0){console.log("检测到出场图片文件:",e.addOutImgs.length,"张");for(let o=0;o<e.addOutImgs.length;o++){const n=e.addOutImgs[o];console.log("处理出场图片",o,":",typeof n,n instanceof File?"是File对象":n instanceof Blob?"是Blob对象":"其他类型"),n instanceof File||n instanceof Blob?(console.log("添加出场图片文件到FormData, 文件名:",n.name||"未命名文件","大小:",n.size,"bytes"),t.append("addOutImgs",n,n.name||`outImg_${Date.now()}_${o}.jpg`)):console.error("出场图片不是文件对象:",typeof n)}}console.log("FormData包含的字段:");for(let o of t.entries())console.log(o[0],o[1]instanceof File?"是File对象":typeof o[1]);n="multipart/form-data"}else console.warn("FormData不可用，使用JSON格式发送请求"),t=JSON.stringify({tradeLogId:e.tradeLogId,count:e.count,outDesc:e.outDesc||"",outPrice:e.outPrice,outImgs:e.outImgs||""})}catch(a){console.warn("FormData创建失败，使用JSON格式:",a),t=JSON.stringify({tradeLogId:e.tradeLogId,count:e.count,outDesc:e.outDesc||"",outPrice:e.outPrice,outImgs:e.outImgs||""})}let s="";try{const e=o("userInfo");if(e){s=("string"==typeof e?JSON.parse(e):e).authorization||""}}catch(r){console.error("获取token失败:",r),s=""}console.log("准备发送请求, URL:","http://192.168.199.113:9999/trade/addOutLog");try{console.log("H5环境，使用fetch上传");const o=new FormData;if("application/json"===n){const e=JSON.parse(t);Object.keys(e).forEach((t=>{o.append(t,e[t])}))}const e=await fetch("http://192.168.199.113:9999/trade/addOutLog",{method:"POST",headers:{Authorization:s?`Bearer ${s}`:""},body:"application/json"===n?o:t});if(!e.ok){const o=await e.text();throw console.error("API请求失败:",e.status,o),new Error(`HTTP error! status: ${e.status}`)}const a=await e.json();if(console.log("API请求成功，返回结果:",a),200==a.code||"200"==a.code)return a;throw new Error(a.msg||a.message||"添加出场记录失败")}catch(r){throw console.error("API请求异常:",r),r}},updOutLog:async e=>{let t;console.log("更新出场日志API被调用，参数:",e);let n="application/json";try{if("undefined"!=typeof FormData&&e.addOutImgs&&e.addOutImgs.length>0){console.log("检测到文件，使用FormData格式"),t=new FormData,t.append("tradeLogOutId",e.tradeLogOutId),t.append("count",e.count),t.append("outDesc",e.outDesc||""),t.append("outPrice",e.outPrice),e.outImgs&&t.append("outImgs",e.outImgs);for(let o=0;o<e.addOutImgs.length;o++){const n=e.addOutImgs[o];(n instanceof File||n instanceof Blob)&&(t.append("addOutImgs",n),console.log("添加出场图片到FormData:",n.name||`blob_${o}`))}n="multipart/form-data"}else console.warn("FormData不可用或无文件，使用JSON格式发送请求"),t=JSON.stringify({tradeLogOutId:e.tradeLogOutId,count:e.count,outDesc:e.outDesc||"",outPrice:e.outPrice,outImgs:e.outImgs||""}),n="application/json"}catch(a){console.warn("FormData创建失败，使用JSON格式:",a),t=JSON.stringify({tradeLogOutId:e.tradeLogOutId,count:e.count,outDesc:e.outDesc||"",outPrice:e.outPrice,outImgs:e.outImgs||""}),n="application/json"}let s="";try{const e=o("userInfo");if(e){s=("string"==typeof e?JSON.parse(e):e).authorization||""}}catch(r){console.error("获取token失败:",r),s=""}console.log("准备发送请求, URL:","http://192.168.199.113:9999/trade/updOutLog");try{console.log("H5环境，使用fetch上传");const o=new FormData;if("application/json"===n){const e=JSON.parse(t);Object.keys(e).forEach((t=>{o.append(t,e[t])}))}const e=await fetch("http://192.168.199.113:9999/trade/updOutLog",{method:"POST",headers:{Authorization:s?`Bearer ${s}`:""},body:"application/json"===n?o:t});if(!e.ok){const o=await e.text();throw console.error("API请求失败:",e.status,o),new Error(`HTTP error! status: ${e.status}`)}const a=await e.json();if(console.log("API请求成功，返回结果:",a),200==a.code||"200"==a.code)return a;throw new Error(a.msg||a.message||"更新出场记录失败")}catch(r){throw console.error("API请求异常:",r),r}},delOutLog:o=>n.delete(`/trade/delOutLog/${o}`)},a=e("constants",(()=>({needRefreshGoods:t(.1)})));export{s as t,a as u};
