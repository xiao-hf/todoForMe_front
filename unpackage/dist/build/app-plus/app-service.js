if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function a(e,t){return"string"==typeof e?t:e}const l=new class{constructor(){this.baseURL="http://110.42.210.113:9999",this.timeout=3e4}request(e){return new Promise(((a,l)=>{let o="";try{const e=uni.getStorageSync("userInfo");if(e){o=("string"==typeof e?JSON.parse(e):e).authorization||""}}catch(n){t("error","at utils/request.js:24","获取token失败:",n),o=""}uni.request({url:this.baseURL+e.url,method:e.method||"GET",data:e.data||{},header:{"Content-Type":"application/json",Authorization:o?`Bearer ${o}`:"",...e.header},timeout:this.timeout,success:e=>{t("log","at utils/request.js:39","API请求成功:",e),200===e.statusCode?"200"===e.data.code||200===e.data.code?a(e.data):(uni.showToast({title:e.data.message||"请求失败",icon:"none"}),l(e.data)):(uni.showToast({title:`请求失败 ${e.statusCode}`,icon:"none"}),l(e))},fail:e=>{t("error","at utils/request.js:61","API请求失败:",e),uni.showToast({title:"网络请求失败",icon:"none"}),l(e)}})}))}get(e,t,a={}){return this.request({url:e,method:"GET",data:t,...a})}post(e,t,a={}){return this.request({url:e,method:"POST",data:t,...a})}put(e,t,a={}){return this.request({url:e,method:"PUT",data:t,...a})}delete(e,t,a={}){return this.request({url:e,method:"DELETE",data:t,...a})}},o=e=>l.get("/user/cost/"+e),n=e=>l.post("/user/login",e),s=e=>l.post("/user/register",e),c=()=>l.get("/user/logout"),i=e=>l.post("/user/updPassword",e),r=e=>l.get("/user/updPasswordCode/"+e),u=(e,t)=>new Promise(((a,o)=>{const n=()=>{const e=uni.getStorageSync("userInfo");return e?"string"==typeof e?JSON.parse(e).authorization:e.authorization:""};t&&t.path?uni.uploadFile({url:l.baseURL+"/user/upd",filePath:t.path,name:"backImg",formData:{nickname:e},header:{Authorization:n()},success:e=>{try{const t=JSON.parse(e.data);a(t)}catch(t){o(t)}},fail:e=>{o(e)}}):uni.request({url:l.baseURL+"/user/upd",method:"POST",header:{"content-type":"application/x-www-form-urlencoded",Authorization:n()},data:{nickname:e},success:e=>{a(e.data)},fail:e=>{o(e)}})})),d=()=>l.get("/user/info"),p=()=>l.get("/user/money");
/*!
   * pinia v2.1.7
   * (c) 2023 Eduardo San Martin Morote
   * @license MIT
   */
let v;const m=e=>v=e,f=Symbol();function h(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var w,g;(g=w||(w={})).direct="direct",g.patchObject="patch object",g.patchFunction="patch function";const V="undefined"!=typeof window;function N(){const t=e.effectScope(!0),a=t.run((()=>e.ref({})));let l=[],o=[];const n=e.markRaw({install(e){m(n),n._a=e,e.provide(f,n),e.config.globalProperties.$pinia=n,o.forEach((e=>l.push(e))),o=[]},use(e){return this._a?l.push(e):o.push(e),this},_p:l,_a:null,_e:t,_s:new Map,state:a});return n}const y=()=>{};function k(t,a,l,o=y){t.push(a);const n=()=>{const e=t.indexOf(a);e>-1&&(t.splice(e,1),o())};return!l&&e.getCurrentScope()&&e.onScopeDispose(n),n}function E(e,...t){e.slice().forEach((e=>{e(...t)}))}const _=e=>e();function b(t,a){t instanceof Map&&a instanceof Map&&a.forEach(((e,a)=>t.set(a,e))),t instanceof Set&&a instanceof Set&&a.forEach(t.add,t);for(const l in a){if(!a.hasOwnProperty(l))continue;const o=a[l],n=t[l];h(n)&&h(o)&&t.hasOwnProperty(l)&&!e.isRef(o)&&!e.isReactive(o)?t[l]=b(n,o):t[l]=o}return t}const C=Symbol();const{assign:x}=Object;function T(t,a,l={},o,n,s){let c;const i=x({actions:{}},l),r={deep:!0};let u,d,p,v=[],f=[];const g=o.state.value[t];let V;function N(a){let l;u=d=!1,"function"==typeof a?(a(o.state.value[t]),l={type:w.patchFunction,storeId:t,events:p}):(b(o.state.value[t],a),l={type:w.patchObject,payload:a,storeId:t,events:p});const n=V=Symbol();e.nextTick().then((()=>{V===n&&(u=!0)})),d=!0,E(v,l,o.state.value[t])}s||g||(o.state.value[t]={}),e.ref({});const T=s?function(){const{state:e}=l,t=e?e():{};this.$patch((e=>{x(e,t)}))}:y;function S(e,a){return function(){m(o);const l=Array.from(arguments),n=[],s=[];function c(e){n.push(e)}function i(e){s.push(e)}let r;E(f,{args:l,name:e,store:B,after:c,onError:i});try{r=a.apply(this&&this.$id===t?this:B,l)}catch(u){throw E(s,u),u}return r instanceof Promise?r.then((e=>(E(n,e),e))).catch((e=>(E(s,e),Promise.reject(e)))):(E(n,r),r)}}const z={_p:o,$id:t,$onAction:k.bind(null,f),$patch:N,$reset:T,$subscribe(a,l={}){const n=k(v,a,l.detached,(()=>s())),s=c.run((()=>e.watch((()=>o.state.value[t]),(e=>{("sync"===l.flush?d:u)&&a({storeId:t,type:w.direct,events:p},e)}),x({},r,l))));return n},$dispose:function(){c.stop(),v=[],f=[],o._s.delete(t)}},B=e.reactive(z);o._s.set(t,B);const I=(o._a&&o._a.runWithContext||_)((()=>o._e.run((()=>(c=e.effectScope()).run(a)))));for(const m in I){const a=I[m];if(e.isRef(a)&&($=a,!e.isRef($)||!$.effect)||e.isReactive(a))s||(!g||h(D=a)&&D.hasOwnProperty(C)||(e.isRef(a)?a.value=g[m]:b(a,g[m])),o.state.value[t][m]=a);else if("function"==typeof a){const e=S(m,a);I[m]=e,i.actions[m]=a}}var D,$;return x(B,I),x(e.toRaw(B),I),Object.defineProperty(B,"$state",{get:()=>o.state.value[t],set:e=>{N((t=>{x(t,e)}))}}),o._p.forEach((e=>{x(B,c.run((()=>e({store:B,app:o._a,pinia:o,options:i}))))})),g&&s&&l.hydrate&&l.hydrate(B.$state,g),u=!0,d=!0,B}function S(t,a,l){let o,n;const s="function"==typeof a;function c(t,l){const c=e.hasInjectionContext();(t=t||(c?e.inject(f,null):null))&&m(t),(t=v)._s.has(o)||(s?T(o,a,n,t):function(t,a,l,o){const{state:n,actions:s,getters:c}=a,i=l.state.value[t];let r;r=T(t,(function(){i||(l.state.value[t]=n?n():{});const a=e.toRefs(l.state.value[t]);return x(a,s,Object.keys(c||{}).reduce(((a,o)=>(a[o]=e.markRaw(e.computed((()=>{m(l);const e=l._s.get(t);return c[o].call(e,e)}))),a)),{}))}),a,l,0,!0)}(o,n,t));return t._s.get(o)}return"string"==typeof t?(o=t,n=s?l:a):(n=t,o=t.id),c.$id=o,c}let z="Store";function B(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]=function(){return e(this.$pinia)[a]},t)),{}):Object.keys(t).reduce(((a,l)=>(a[l]=function(){const a=e(this.$pinia),o=t[l];return"function"==typeof o?o.call(this,a):a[o]},a)),{})}const I=B;const D=Object.freeze(Object.defineProperty({__proto__:null,get MutationType(){return w},PiniaVuePlugin:function(e){e.mixin({beforeCreate(){const e=this.$options;if(e.pinia){const t=e.pinia;if(!this._provided){const e={};Object.defineProperty(this,"_provided",{get:()=>e,set:t=>Object.assign(e,t)})}this._provided[f]=t,this.$pinia||(this.$pinia=t),t._a=this,V&&m(t)}else!this.$pinia&&e.parent&&e.parent.$pinia&&(this.$pinia=e.parent.$pinia)},destroyed(){delete this._pStores}})},acceptHMRUpdate:function(e,t){return()=>{}},createPinia:N,defineStore:S,getActivePinia:()=>e.hasInjectionContext()&&e.inject(f)||v,mapActions:function(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]=function(...t){return e(this.$pinia)[a](...t)},t)),{}):Object.keys(t).reduce(((a,l)=>(a[l]=function(...a){return e(this.$pinia)[t[l]](...a)},a)),{})},mapGetters:I,mapState:B,mapStores:function(...e){return e.reduce(((e,t)=>(e[t.$id+z]=function(){return t(this.$pinia)},e)),{})},mapWritableState:function(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]={get(){return e(this.$pinia)[a]},set(t){return e(this.$pinia)[a]=t}},t)),{}):Object.keys(t).reduce(((a,l)=>(a[l]={get(){return e(this.$pinia)[t[l]]},set(a){return e(this.$pinia)[t[l]]=a}},a)),{})},setActivePinia:m,setMapStoreSuffix:function(e){z=e},skipHydrate:function(e){return Object.defineProperty(e,C,{})},storeToRefs:function(t){{t=e.toRaw(t);const a={};for(const l in t){const o=t[l];(e.isRef(o)||e.isReactive(o))&&(a[l]=e.toRef(t,l))}return a}}},Symbol.toStringTag,{value:"Module"})),$=S("user",(()=>{const a=e.ref({authorization:"",money:12580,backgroudImg:""}),l=e.ref([]),o=()=>{try{const e=uni.getStorageSync("userInfo");if(e){const t="string"==typeof e?JSON.parse(e):e;a.value={...a.value,...t}}}catch(e){t("error","at stores/user.js:24","恢复用户信息失败:",e)}};o();const n=()=>{a.value={id:"",username:"",email:"",nickname:"",avatar:"",phone:"",gender:0,birthday:"",bio:"",status:0,isVerified:0,lastLoginTime:"",lastLoginIp:"",loginCount:0,aiQuota:0,aiUsed:0,apiKey:"",settings:"",createdAt:"",role:{id:null,roleName:"",roleCode:"",roleDesc:"",status:0,createdAt:"",updatedAt:""},authorization:"",money:0,backgroudImg:""}};return{userInfo:a,setUserInfo:e=>{a.value=e,uni.setStorageSync("userInfo",JSON.stringify(a.value))},clearUserInfo:n,logout:()=>{n(),uni.removeStorageSync("userInfo")},initUserInfo:o,username:e.computed((()=>a.value.username)),avatar:e.computed((()=>a.value.avatar)),parseAudioList:l}})),A={__name:"index",setup(t){const a=$(),l=e.ref(""),o=e.ref(""),s=e.ref(!1);function c(){s.value=!s.value}return(t,i)=>(e.openBlock(),e.createElementBlock("view",{class:"t-login"},[e.createElementVNode("image",{class:"img-a",src:"/static/2.png"}),e.createElementVNode("image",{class:"img-b",src:"/static/3.png"}),e.createElementVNode("view",{class:"t-b"},e.toDisplayString(t.title),1),e.createElementVNode("view",{class:"t-b2"},"欢迎使用，todo+"),e.createElementVNode("form",{class:"cl"},[e.createElementVNode("view",{class:"t-a"},[e.createElementVNode("image",{src:"/static/sj.png"}),e.createElementVNode("view",{class:"line"}),e.withDirectives(e.createElementVNode("input",{type:"number",name:"phone",placeholder:"请输入手机号",maxlength:"11","onUpdate:modelValue":i[0]||(i[0]=e=>l.value=e)},null,512),[[e.vModelText,l.value]])]),e.createElementVNode("view",{class:"t-a"},[e.createElementVNode("image",{src:"/static/yz.png"}),e.createElementVNode("view",{class:"line"}),e.withDirectives(e.createElementVNode("input",{type:s.value?"text":"password",name:"code",placeholder:"请输入密码","onUpdate:modelValue":i[1]||(i[1]=e=>o.value=e)},null,8,["type"]),[[e.vModelDynamic,o.value]]),e.createElementVNode("view",{class:"eye-icon",onClick:c},[e.createElementVNode("text",null,e.toDisplayString(s.value?"👁️":"👁️‍🗨️"),1)])]),e.createElementVNode("button",{onClick:i[2]||(i[2]=e=>(async()=>{if(!l.value)return void uni.showToast({title:"请输入手机号",icon:"none"});if(!/^[1][3,4,5,7,8,9][0-9]{9}$/.test(l.value))return void uni.showToast({title:"请输入正确手机号",icon:"none"});if(!o.value)return void uni.showToast({title:"请输入密码",icon:"none"});const e=await n({phone:l.value,code:o.value,type:1});200===e.code||"200"===e.code?(a.setUserInfo(e.data),uni.showToast({title:"登录成功",icon:"success"}),uni.navigateTo({url:"/pages/home/home"})):uni.showToast({title:"登录失败",icon:"none"})})())},"登 录"),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("button",{type:"primary",style:{"background-color":"gray"},plain:"true",class:"t-forget",onClick:i[3]||(i[3]=e=>{uni.navigateTo({url:"/pages/changePassword/changePassword"})})},"忘记密码"),e.createElementVNode("button",{type:"primary",style:{"background-color":"rgb(109, 142, 160)"},plain:"true",class:"t-register",onClick:i[4]||(i[4]=e=>{uni.navigateTo({url:"/pages/register/register"})})},"注册")])])]))}},P=[{font_class:"arrow-down",unicode:""},{font_class:"arrow-left",unicode:""},{font_class:"arrow-right",unicode:""},{font_class:"arrow-up",unicode:""},{font_class:"auth",unicode:""},{font_class:"auth-filled",unicode:""},{font_class:"back",unicode:""},{font_class:"bars",unicode:""},{font_class:"calendar",unicode:""},{font_class:"calendar-filled",unicode:""},{font_class:"camera",unicode:""},{font_class:"camera-filled",unicode:""},{font_class:"cart",unicode:""},{font_class:"cart-filled",unicode:""},{font_class:"chat",unicode:""},{font_class:"chat-filled",unicode:""},{font_class:"chatboxes",unicode:""},{font_class:"chatboxes-filled",unicode:""},{font_class:"chatbubble",unicode:""},{font_class:"chatbubble-filled",unicode:""},{font_class:"checkbox",unicode:""},{font_class:"checkbox-filled",unicode:""},{font_class:"checkmarkempty",unicode:""},{font_class:"circle",unicode:""},{font_class:"circle-filled",unicode:""},{font_class:"clear",unicode:""},{font_class:"close",unicode:""},{font_class:"closeempty",unicode:""},{font_class:"cloud-download",unicode:""},{font_class:"cloud-download-filled",unicode:""},{font_class:"cloud-upload",unicode:""},{font_class:"cloud-upload-filled",unicode:""},{font_class:"color",unicode:""},{font_class:"color-filled",unicode:""},{font_class:"compose",unicode:""},{font_class:"contact",unicode:""},{font_class:"contact-filled",unicode:""},{font_class:"down",unicode:""},{font_class:"bottom",unicode:""},{font_class:"download",unicode:""},{font_class:"download-filled",unicode:""},{font_class:"email",unicode:""},{font_class:"email-filled",unicode:""},{font_class:"eye",unicode:""},{font_class:"eye-filled",unicode:""},{font_class:"eye-slash",unicode:""},{font_class:"eye-slash-filled",unicode:""},{font_class:"fire",unicode:""},{font_class:"fire-filled",unicode:""},{font_class:"flag",unicode:""},{font_class:"flag-filled",unicode:""},{font_class:"folder-add",unicode:""},{font_class:"folder-add-filled",unicode:""},{font_class:"font",unicode:""},{font_class:"forward",unicode:""},{font_class:"gear",unicode:""},{font_class:"gear-filled",unicode:""},{font_class:"gift",unicode:""},{font_class:"gift-filled",unicode:""},{font_class:"hand-down",unicode:""},{font_class:"hand-down-filled",unicode:""},{font_class:"hand-up",unicode:""},{font_class:"hand-up-filled",unicode:""},{font_class:"headphones",unicode:""},{font_class:"heart",unicode:""},{font_class:"heart-filled",unicode:""},{font_class:"help",unicode:""},{font_class:"help-filled",unicode:""},{font_class:"home",unicode:""},{font_class:"home-filled",unicode:""},{font_class:"image",unicode:""},{font_class:"image-filled",unicode:""},{font_class:"images",unicode:""},{font_class:"images-filled",unicode:""},{font_class:"info",unicode:""},{font_class:"info-filled",unicode:""},{font_class:"left",unicode:""},{font_class:"link",unicode:""},{font_class:"list",unicode:""},{font_class:"location",unicode:""},{font_class:"location-filled",unicode:""},{font_class:"locked",unicode:""},{font_class:"locked-filled",unicode:""},{font_class:"loop",unicode:""},{font_class:"mail-open",unicode:""},{font_class:"mail-open-filled",unicode:""},{font_class:"map",unicode:""},{font_class:"map-filled",unicode:""},{font_class:"map-pin",unicode:""},{font_class:"map-pin-ellipse",unicode:""},{font_class:"medal",unicode:""},{font_class:"medal-filled",unicode:""},{font_class:"mic",unicode:""},{font_class:"mic-filled",unicode:""},{font_class:"micoff",unicode:""},{font_class:"micoff-filled",unicode:""},{font_class:"minus",unicode:""},{font_class:"minus-filled",unicode:""},{font_class:"more",unicode:""},{font_class:"more-filled",unicode:""},{font_class:"navigate",unicode:""},{font_class:"navigate-filled",unicode:""},{font_class:"notification",unicode:""},{font_class:"notification-filled",unicode:""},{font_class:"paperclip",unicode:""},{font_class:"paperplane",unicode:""},{font_class:"paperplane-filled",unicode:""},{font_class:"person",unicode:""},{font_class:"person-filled",unicode:""},{font_class:"personadd",unicode:""},{font_class:"personadd-filled",unicode:""},{font_class:"personadd-filled-copy",unicode:""},{font_class:"phone",unicode:""},{font_class:"phone-filled",unicode:""},{font_class:"plus",unicode:""},{font_class:"plus-filled",unicode:""},{font_class:"plusempty",unicode:""},{font_class:"pulldown",unicode:""},{font_class:"pyq",unicode:""},{font_class:"qq",unicode:""},{font_class:"redo",unicode:""},{font_class:"redo-filled",unicode:""},{font_class:"refresh",unicode:""},{font_class:"refresh-filled",unicode:""},{font_class:"refreshempty",unicode:""},{font_class:"reload",unicode:""},{font_class:"right",unicode:""},{font_class:"scan",unicode:""},{font_class:"search",unicode:""},{font_class:"settings",unicode:""},{font_class:"settings-filled",unicode:""},{font_class:"shop",unicode:""},{font_class:"shop-filled",unicode:""},{font_class:"smallcircle",unicode:""},{font_class:"smallcircle-filled",unicode:""},{font_class:"sound",unicode:""},{font_class:"sound-filled",unicode:""},{font_class:"spinner-cycle",unicode:""},{font_class:"staff",unicode:""},{font_class:"staff-filled",unicode:""},{font_class:"star",unicode:""},{font_class:"star-filled",unicode:""},{font_class:"starhalf",unicode:""},{font_class:"trash",unicode:""},{font_class:"trash-filled",unicode:""},{font_class:"tune",unicode:""},{font_class:"tune-filled",unicode:""},{font_class:"undo",unicode:""},{font_class:"undo-filled",unicode:""},{font_class:"up",unicode:""},{font_class:"top",unicode:""},{font_class:"upload",unicode:""},{font_class:"upload-filled",unicode:""},{font_class:"videocam",unicode:""},{font_class:"videocam-filled",unicode:""},{font_class:"vip",unicode:""},{font_class:"vip-filled",unicode:""},{font_class:"wallet",unicode:""},{font_class:"wallet-filled",unicode:""},{font_class:"weibo",unicode:""},{font_class:"weixin",unicode:""}],M=(e,t)=>{const a=e.__vccOpts||e;for(const[l,o]of t)a[l]=o;return a};const U=M({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""},fontFamily:{type:String,default:""}},data:()=>({icons:P}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?e.unicode:""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e},styleObj(){return""!==this.fontFamily?`color: ${this.color}; font-size: ${this.iconSize}; font-family: ${this.fontFamily};`:`color: ${this.color}; font-size: ${this.iconSize};`}},methods:{_onClick(){this.$emit("click")}}},[["render",function(t,a,l,o,n,s){return e.openBlock(),e.createElementBlock("text",{style:e.normalizeStyle(s.styleObj),class:e.normalizeClass(["uni-icons",["uniui-"+l.type,l.customPrefix,l.customPrefix?l.type:""]]),onClick:a[0]||(a[0]=(...e)=>s._onClick&&s._onClick(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)}],["__scopeId","data-v-5610c8db"]]);const L=M({name:"UniCard",emits:["click"],props:{title:{type:String,default:""},subTitle:{type:String,default:""},padding:{type:String,default:"10px"},margin:{type:String,default:"15px"},spacing:{type:String,default:"0 10px"},extra:{type:String,default:""},cover:{type:String,default:""},thumbnail:{type:String,default:""},isFull:{type:Boolean,default:!1},isShadow:{type:Boolean,default:!0},shadow:{type:String,default:"0px 0px 3px 1px rgba(0, 0, 0, 0.08)"},border:{type:Boolean,default:!0}},methods:{onClick(e){this.$emit("click",e)}}},[["render",function(t,a,l,o,n,s){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-card",{"uni-card--full":l.isFull,"uni-card--shadow":l.isShadow,"uni-card--border":l.border}]),style:e.normalizeStyle({margin:l.isFull?0:l.margin,padding:l.spacing,"box-shadow":l.isShadow?l.shadow:""})},[e.renderSlot(t.$slots,"cover",{},(()=>[l.cover?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-card__cover"},[e.createElementVNode("image",{class:"uni-card__cover-image",mode:"widthFix",onClick:a[0]||(a[0]=e=>s.onClick("cover")),src:l.cover},null,8,["src"])])):e.createCommentVNode("",!0)]),!0),e.renderSlot(t.$slots,"title",{},(()=>[l.title||l.extra?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-card__header"},[e.createElementVNode("view",{class:"uni-card__header-box",onClick:a[1]||(a[1]=e=>s.onClick("title"))},[l.thumbnail?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-card__header-avatar"},[e.createElementVNode("image",{class:"uni-card__header-avatar-image",src:l.thumbnail,mode:"aspectFit"},null,8,["src"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-card__header-content"},[e.createElementVNode("text",{class:"uni-card__header-content-title uni-ellipsis"},e.toDisplayString(l.title),1),l.title&&l.subTitle?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-card__header-content-subtitle uni-ellipsis"},e.toDisplayString(l.subTitle),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"uni-card__header-extra",onClick:a[2]||(a[2]=e=>s.onClick("extra"))},[e.createElementVNode("text",{class:"uni-card__header-extra-text"},e.toDisplayString(l.extra),1)])])):e.createCommentVNode("",!0)]),!0),e.createElementVNode("view",{class:"uni-card__content",style:e.normalizeStyle({padding:l.padding}),onClick:a[3]||(a[3]=e=>s.onClick("content"))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],4),e.createElementVNode("view",{class:"uni-card__actions",onClick:a[4]||(a[4]=e=>s.onClick("actions"))},[e.renderSlot(t.$slots,"actions",{},void 0,!0)])],6)}],["__scopeId","data-v-a4d554f5"]]),O=()=>l.get("/util/now"),j=e=>l.post("/task/queryList",e),X=e=>l.post("/task/add",e),F=e=>l.post("/task/upd",e),R=e=>l.delete(`/task/del/${e}`),Z=e=>l.get(`/task/complete/${e}`),q=e=>l.get(`/task/like/${e}`),G=M({__name:"home",setup(l){const n=$(),s=e.ref([]),i=e.ref({description:"",value:"1"}),r=e.ref(!1),v=e.ref(!1),m=e.ref(!1),f=e.ref(!1),h=e.ref(!1),w=e.ref(!1),g=e.ref({id:null,description:"",value:"1"}),V=e.ref(!0),N=e.ref(Date.now());let y=null;const k=e.ref({}),E=e.ref(0),_=e.ref(0),b=e.ref(null),C=e.ref(!1),x=e.ref(null),T=e.ref(!1),S=e.ref(!1),z=e.ref(!1),B=e.ref(!1),I=e.ref(!1),D=e.ref(!1),A=e.ref("1"),P=e.ref(!1),M=e.ref(0),G=e.ref(0),Y=e.ref({translateX:0,showCost:!1}),J=e.ref({nickname:"",backImg:null}),H=e.ref(""),W=e.ref(!1);async function K(){const e=await p();n.userInfo.money=e.data,n.setUserInfo(n.userInfo)}const Q=e.computed((()=>n.userInfo.backgroudImg||"")),ee=e.computed((()=>{const e=new Date(N.value);return`${e.getMonth()+1}月${e.getDate()}日 ${["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][e.getDay()]}`}));e.computed((()=>Q.value&&!W.value));const te=e.computed((()=>(n.userInfo.money||0).toLocaleString())),ae=e.computed((()=>s.value.filter((e=>!e.isCompleted)).sort(((e,t)=>(e.sort||0)-(t.sort||0))))),le=e.computed((()=>s.value.filter((e=>e.isCompleted)).sort(((e,t)=>(e.sort||0)-(t.sort||0))))),oe=()=>{J.value.nickname=n.userInfo.nickname||"",J.value.backImg=null,H.value=n.userInfo.backgroudImg||"",z.value=!0},ne=()=>{T.value=!0},se=async e=>{try{const t=await Z(e);200===t.code||"200"===t.code?(await je(),K()):uni.showToast({title:t.message||"操作失败",icon:"none"})}catch(a){t("error","at pages/home/home.vue:502","切换任务状态失败:",a),uni.showToast({title:"操作失败",icon:"none"})}},ce=async e=>{try{const t=await q(e);200===t.code||"200"===t.code?await je():uni.showToast({title:t.message||"操作失败",icon:"none"})}catch(a){t("error","at pages/home/home.vue:523","切换收藏状态失败:",a),uni.showToast({title:"操作失败",icon:"none"})}},ie=()=>{V.value=!V.value},re=(e,t)=>{E.value=e.touches[0].clientX,_.value=e.touches[0].clientY,b.value=t},ue=(e,t)=>{if(b.value!==t)return;const a=e.touches[0].clientX,l=e.touches[0].clientY,o=a-E.value,n=l-_.value;if(!(Math.abs(n)>Math.abs(o))&&o<0){const e=Math.max(.5*o,-120);k.value[t]||(k.value[t]={}),k.value[t].translateX=e,k.value[t].showDelete=e<-30}},de=(e,t)=>{if(b.value!==t)return;const a=k.value[t];a&&(a.translateX<-60?fe(t):a.translateX<-30?(a.translateX=-120,a.showDelete=!0):pe(t),b.value=null)},pe=e=>{k.value[e]&&(k.value[e].translateX=0,k.value[e].showDelete=!1)},ve=()=>{Object.keys(k.value).forEach((e=>{pe(e)}))},me=()=>{ve(),Se()},fe=e=>{ve(),x.value=e,C.value=!0},he=()=>{C.value=!1,x.value=null},we=async()=>{if(x.value){uni.showLoading({title:"删除中..."});try{const e=await R(x.value);uni.hideLoading(),200===e.code||"200"===e.code?(uni.showToast({title:"任务已删除",icon:"success"}),await je()):uni.showToast({title:e.message||"删除失败",icon:"none"})}catch(e){uni.hideLoading(),uni.showToast({title:"删除失败",icon:"none"}),t("error","at pages/home/home.vue:646","删除任务失败:",e)}finally{he()}}},ge=()=>{S.value=!0,setTimeout((()=>{T.value=!1,S.value=!1}),300)},Ve=()=>{ge(),setTimeout((()=>{uni.showToast({title:"跳转到收藏页面",icon:"none"})}),300)},Ne=()=>{},ye=()=>{ge(),setTimeout((()=>{uni.showToast({title:"跳转到图表页面",icon:"none"})}),300)},ke=()=>{ge(),setTimeout((()=>{uni.navigateTo({url:"/pages/template/template"})}),300)},Ee=()=>{r.value=!0,setTimeout((()=>{m.value=!0}),300)},_e=(e,t)=>{t&&t.stopPropagation(),e.isCompleted||(g.value={id:e.id,description:e.taskDescription,value:e.value?e.value.toString():"1"},f.value=!0,setTimeout((()=>{w.value=!0}),300))},be=()=>{h.value=!0,w.value=!1,setTimeout((()=>{f.value=!1,h.value=!1,g.value={id:null,description:"",value:"1"}}),300)},Ce=e=>{M.value=e.touches[0].clientX,G.value=e.touches[0].clientY},xe=e=>{const t=e.touches[0].clientX,a=e.touches[0].clientY,l=t-M.value,o=a-G.value;if(!(Math.abs(o)>Math.abs(l))&&l<0){const e=Math.max(.5*l,-120);Y.value.translateX=e,Y.value.showCost=e<-30}},Te=e=>{e.changedTouches[0].clientX;M.value,Y.value.translateX<-30?(I.value=!0,setTimeout((()=>{P.value=!0}),300),setTimeout((()=>{Se()}),100),e.preventDefault(),e.stopPropagation()):Se()},Se=()=>{Y.value.translateX=0,Y.value.showCost=!1},ze=()=>{v.value=!0,m.value=!1,setTimeout((()=>{r.value=!1,v.value=!1,i.value={description:"",value:"1"}}),300)},Be=async()=>{if(i.value.description.trim()){uni.showLoading({title:"添加中..."});try{const e={desc:i.value.description.trim(),value:parseInt(i.value.value)||1},t=await X(e);uni.hideLoading(),200===t.code||"200"===t.code?(ze(),uni.showToast({title:"任务添加成功",icon:"success"}),je()):uni.showToast({title:t.message||"添加失败",icon:"none"})}catch(e){uni.hideLoading(),uni.showToast({title:"添加失败",icon:"none"}),t("error","at pages/home/home.vue:876","添加任务失败:",e)}}else uni.showToast({title:"请输入任务描述",icon:"none"})},Ie=async()=>{if(g.value.description.trim()){uni.showLoading({title:"修改中..."});try{const e={id:g.value.id,desc:g.value.description.trim(),value:parseInt(g.value.value)||1},t=await F(e);uni.hideLoading(),200===t.code||"200"===t.code?(be(),uni.showToast({title:"任务修改成功",icon:"success"}),je()):uni.showToast({title:t.message||"修改失败",icon:"none"})}catch(e){uni.hideLoading(),uni.showToast({title:"修改失败",icon:"none"}),t("error","at pages/home/home.vue:923","修改任务失败:",e)}}else uni.showToast({title:"请输入任务描述",icon:"none"})},De=e=>{let t=e.detail.value||e.target.value;t=t.replace(/[^\d]/g,""),t&&parseInt(t)<1&&(t="1"),t||(t="1"),i.value.value=t},$e=()=>{const e=parseInt(i.value.value)||1;i.value.value=(e+1).toString()},Ae=()=>{const e=parseInt(i.value.value)||1;e>1&&(i.value.value=(e-1).toString())},Pe=e=>{let t=e.detail.value||e.target.value;t=t.replace(/[^\d]/g,""),t&&parseInt(t)<1&&(t="1"),t||(t="1"),g.value.value=t},Me=()=>{const e=parseInt(g.value.value)||1;g.value.value=(e+1).toString()},Ue=()=>{const e=parseInt(g.value.value)||1;e>1&&(g.value.value=(e-1).toString())},Le=async()=>{try{const e=await O();e&&e.data&&(N.value=e.data)}catch(e){t("error","at pages/home/home.vue:987","获取服务器时间失败:",e),N.value=Date.now()}},Oe=()=>{y&&clearTimeout(y);const e=new Date(N.value),a=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0,0,0,0).getTime()-e.getTime();y=setTimeout((async()=>{await Le(),t("log","at pages/home/home.vue:1009","自动更新时间:",new Date(N.value)),Oe()}),a),t("log","at pages/home/home.vue:1015",`设置每日更新定时器，${Math.round(a/1e3/60)} 分钟后触发`)},je=async()=>{try{const e=await j({isToday:!0,pageNo:1,pageSize:1e4});e&&"200"===e.code&&e.data&&e.data.list&&(s.value=e.data.list)}catch(e){t("error","at pages/home/home.vue:1026","获取任务列表失败:",e),uni.showToast({title:"获取任务列表失败",icon:"none"})}},Xe=()=>{W.value=!0,uni.showToast({title:"背景图片加载失败",icon:"none"})},Fe=()=>{W.value=!1},Re=()=>{uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:e=>{const t=e.tempFilePaths[0];uni.getFileInfo({filePath:t,success:e=>{J.value.backImg={path:t,size:e.size},H.value=t}})},fail:()=>{uni.showToast({title:"选择图片失败",icon:"none"})}})},Ze=()=>{J.value.backImg=null,H.value=""},qe=()=>{B.value=!0,setTimeout((()=>{z.value=!1,B.value=!1,J.value={nickname:"",backImg:null},H.value=""}),300)},Ge=async()=>{if(J.value.nickname.trim()){uni.showLoading({title:"更新中..."});try{const e=await u(J.value.nickname.trim(),J.value.backImg);if(uni.hideLoading(),200===e.code||"200"===e.code){const t={...n.userInfo,nickname:J.value.nickname.trim()};e.data&&e.data.backImg?t.backgroudImg=e.data.backImg:H.value&&J.value.backImg&&(t.backgroudImg=H.value),n.setUserInfo(t),uni.showToast({title:"修改成功",icon:"success"}),qe(),async function(){const e=await d();n.userInfo=e.data,n.setUserInfo(n.userInfo)}()}else uni.showToast({title:e.message||"修改失败",icon:"none"})}catch(e){uni.hideLoading(),uni.showToast({title:"修改失败",icon:"none"}),t("error","at pages/home/home.vue:1147","修改用户信息失败:",e)}}else uni.showToast({title:"请输入昵称",icon:"none"})},Ye=()=>{I.value=!0,setTimeout((()=>{P.value=!0}),300)},Je=()=>{D.value=!0,P.value=!1,setTimeout((()=>{I.value=!1,D.value=!1,A.value="1",Se()}),300)},He=e=>{let t=e.detail.value||e.target.value;t=t.replace(/[^\d]/g,""),t&&parseInt(t)<1&&(t="1"),t||(t="1"),A.value=t},We=async()=>{const e=parseInt(A.value);if(!e||e<1)uni.showToast({title:"请输入有效金额",icon:"none"});else{uni.showLoading({title:"消费中..."});try{const a=await o(e);uni.hideLoading(),200===a.code||"200"===a.code?(uni.showToast({title:"消费成功",icon:"success"}),Je(),await K()):(t("log","at pages/home/home.vue:1213","xxx",a),uni.showToast({title:a.data.message||"消费失败",icon:"none"}))}catch(a){uni.hideLoading(),uni.showToast({title:res.data.message||"消费失败",icon:"none"}),t("error","at pages/home/home.vue:1225","消费失败:",a)}}},Ke=async()=>{uni.showModal({title:"确认退出",content:"确定要退出登录吗？",success:async e=>{if(e.confirm){uni.showLoading({title:"退出中..."});try{await c()}catch(a){t("error","at pages/home/home.vue:1244","调用退出登录接口失败:",a)}finally{n.logout(),uni.hideLoading(),uni.showToast({title:"已退出登录",icon:"success"}),setTimeout((()=>{uni.reLaunch({url:"/pages/index/index"})}),1e3)}}}})};return e.onMounted((async()=>{await Le(),Oe(),n.initUserInfo(),je()})),e.onUnmounted((()=>{y&&(clearTimeout(y),y=null)})),(t,l)=>{var o;const n=a(e.resolveDynamicComponent("uni-icons"),U),c=a(e.resolveDynamicComponent("uni-card"),L);return e.openBlock(),e.createElementBlock("view",{class:"home-container"},[Q.value?(e.openBlock(),e.createElementBlock("image",{key:0,src:Q.value,class:"background-image",mode:"aspectFill",onError:Xe,onLoad:Fe},null,40,["src"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"nav-header"},[e.createElementVNode("view",{class:"nav-left"},[e.createVNode(n,{type:"gear",size:"24",color:"#fff",onClick:oe})]),e.createElementVNode("view",{class:"nav-center"},[e.createElementVNode("text",{class:"money-text"},"¥"+e.toDisplayString(te.value),1)]),e.createElementVNode("view",{class:"nav-right"},[e.createVNode(n,{type:"more-filled",size:"24",color:"#fff",onClick:ne}),e.createVNode(n,{type:"undo",size:"24",color:"#fff",onClick:Ke})])]),e.createElementVNode("view",{class:"date-header"},[e.createElementVNode("text",{class:"date-info"},e.toDisplayString(ee.value),1)]),e.createElementVNode("scroll-view",{class:"task-list","scroll-y":"true",onScroll:me},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(ae.value,((t,a)=>(e.openBlock(),e.createBlock(c,{key:t.id,"is-shadow":!1,border:!1,margin:"8rpx 20rpx",class:"task-card task-swipe-container"},{default:e.withCtx((()=>{var a,l;return[e.createElementVNode("view",{class:"task-swipe-wrapper"},[e.createElementVNode("view",{class:"task-item",style:e.normalizeStyle({transform:`translateX(${(null==(a=k.value[t.id])?void 0:a.translateX)||0}rpx)`}),onTouchstart:e=>re(e,t.id),onTouchmove:e=>ue(e,t.id),onTouchend:e=>de(0,t.id)},[e.createElementVNode("view",{class:"task-checkbox",onClick:e=>se(t.id)},[e.createVNode(n,{type:"checkbox",size:24,color:"#C7C7CC"})],8,["onClick"]),e.createElementVNode("view",{class:"task-content",onClick:e=>_e(t,e)},[e.createElementVNode("text",{class:"task-description"},e.toDisplayString(t.taskDescription),1),t.value&&t.value>=1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-value"},[e.createVNode(n,{type:"wallet",size:"14",color:"#666"}),e.createElementVNode("text",{class:"value-text"},e.toDisplayString(t.value),1)])):e.createCommentVNode("",!0)],8,["onClick"]),e.createElementVNode("view",{class:"task-actions"},[e.createVNode(n,{type:t.like?"star-filled":"star",size:24,color:t.like?"#FFD700":"#C7C7CC",onClick:e=>ce(t.id)},null,8,["type","color","onClick"])])],44,["onTouchstart","onTouchmove","onTouchend"]),(null==(l=k.value[t.id])?void 0:l.showDelete)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"delete-action",onClick:e=>fe(t.id)},[e.createVNode(n,{type:"trash",size:"24",color:"#fff"})],8,["onClick"])):e.createCommentVNode("",!0)])]})),_:2},1024)))),128)),le.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"section-title",onClick:ie},[e.createVNode(n,{type:V.value?"down":"right",size:"16",color:"rgba(255, 255, 255, 0.7)"},null,8,["type"]),e.createElementVNode("text",{class:"section-text"},"已完成")])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["completed-tasks-container",{collapsed:!V.value}])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(le.value,((t,a)=>(e.openBlock(),e.createBlock(c,{key:t.id,"is-shadow":!1,border:!1,margin:"8rpx 20rpx",class:"task-card task-swipe-container"},{default:e.withCtx((()=>{var a,l;return[e.createElementVNode("view",{class:"task-swipe-wrapper"},[e.createElementVNode("view",{class:"task-item",style:e.normalizeStyle({transform:`translateX(${(null==(a=k.value[t.id])?void 0:a.translateX)||0}rpx)`}),onTouchstart:e=>re(e,t.id),onTouchmove:e=>ue(e,t.id),onTouchend:e=>de(0,t.id)},[e.createElementVNode("view",{class:"task-checkbox",onClick:e=>se(t.id)},[e.createVNode(n,{type:"checkboxfilled",size:24,color:"#4CD964"})],8,["onClick"]),e.createElementVNode("view",{class:"task-content completed-task",onClick:e=>_e(t,e)},[e.createElementVNode("text",{class:"task-description completed"},e.toDisplayString(t.taskDescription),1),t.value&&t.value>=1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-value"},[e.createVNode(n,{type:"wallet",size:"14",color:"#666"}),e.createElementVNode("text",{class:"value-text"},e.toDisplayString(t.value),1)])):e.createCommentVNode("",!0)],8,["onClick"]),e.createElementVNode("view",{class:"task-actions"},[e.createVNode(n,{type:t.like?"star-filled":"star",size:24,color:t.like?"#FFD700":"#C7C7CC",onClick:e=>ce(t.id)},null,8,["type","color","onClick"])])],44,["onTouchstart","onTouchmove","onTouchend"]),(null==(l=k.value[t.id])?void 0:l.showDelete)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"delete-action",onClick:e=>fe(t.id)},[e.createVNode(n,{type:"trash",size:"24",color:"#fff"})],8,["onClick"])):e.createCommentVNode("",!0)])]})),_:2},1024)))),128))],2)],32),e.createElementVNode("view",{class:"add-task-container"},[e.createElementVNode("view",{class:"add-task-swipe-wrapper"},[e.createElementVNode("view",{class:"add-task-btn",style:e.normalizeStyle({transform:`translateX(${Y.value.translateX}rpx)`}),onClick:Ee,onTouchstart:Ce,onTouchmove:xe,onTouchend:Te},[e.createVNode(n,{type:"plus",size:"20",color:"#fff"}),e.createElementVNode("text",{class:"add-btn-text"},"添加任务")],36),Y.value.showCost?(e.openBlock(),e.createElementBlock("view",{key:0,class:"cost-action",onClick:Ye},[e.createVNode(n,{type:"wallet",size:"24",color:"#fff"})])):e.createCommentVNode("",!0)])]),r.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-overlay",onClick:ze},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content",{closing:v.value}]),onClick:l[3]||(l[3]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"新建任务"),e.createElementVNode("view",{class:"popup-close",onClick:ze},[e.createVNode(n,{type:"close",size:"20",color:"#666"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务描述"),e.withDirectives(e.createElementVNode("input",{class:"task-input","onUpdate:modelValue":l[0]||(l[0]=e=>i.value.description=e),placeholder:"请输入任务描述...",maxlength:"100",focus:m.value,onBlur:l[1]||(l[1]=e=>m.value=!1)},null,40,["focus"]),[[e.vModelText,i.value.description]])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务价值"),e.createElementVNode("view",{class:"number-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"task-input number-input","onUpdate:modelValue":l[2]||(l[2]=e=>i.value.value=e),type:"number",placeholder:"最小值为1",onInput:De},null,544),[[e.vModelText,i.value.value]]),e.createElementVNode("view",{class:"number-controls"},[e.createElementVNode("view",{class:"control-btn increase-btn",onClick:$e},[e.createVNode(n,{type:"plus",size:"20",color:"#fff"})]),e.createElementVNode("view",{class:"control-btn decrease-btn",onClick:Ae},[e.createVNode(n,{type:"minus",size:"20",color:"#fff"})])])])]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:ze},"取消"),e.createElementVNode("button",{class:"confirm-btn",onClick:Be,disabled:!i.value.description.trim()},"确认添加",8,["disabled"])])],2)])):e.createCommentVNode("",!0),f.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal-overlay",onClick:be},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content",{closing:h.value}]),onClick:l[7]||(l[7]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"修改任务"),e.createElementVNode("view",{class:"popup-close",onClick:be},[e.createVNode(n,{type:"close",size:"20",color:"#666"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务描述"),e.withDirectives(e.createElementVNode("input",{class:"task-input","onUpdate:modelValue":l[4]||(l[4]=e=>g.value.description=e),placeholder:"请输入任务描述...",maxlength:"100",focus:w.value,onBlur:l[5]||(l[5]=e=>w.value=!1)},null,40,["focus"]),[[e.vModelText,g.value.description]])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务价值"),e.createElementVNode("view",{class:"number-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"task-input number-input","onUpdate:modelValue":l[6]||(l[6]=e=>g.value.value=e),type:"number",placeholder:"最小值为1",onInput:Pe},null,544),[[e.vModelText,g.value.value]]),e.createElementVNode("view",{class:"number-controls"},[e.createElementVNode("view",{class:"control-btn increase-btn",onClick:Me},[e.createVNode(n,{type:"plus",size:"20",color:"#fff"})]),e.createElementVNode("view",{class:"control-btn decrease-btn",onClick:Ue},[e.createVNode(n,{type:"minus",size:"20",color:"#fff"})])])])]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:be},"取消"),e.createElementVNode("button",{class:"confirm-btn",onClick:Ie,disabled:!g.value.description.trim()},"确认修改",8,["disabled"])])],2)])):e.createCommentVNode("",!0),z.value?(e.openBlock(),e.createElementBlock("view",{key:3,class:"modal-overlay",onClick:qe},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content",{closing:B.value}]),onClick:l[9]||(l[9]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"修改用户信息"),e.createElementVNode("view",{class:"popup-close",onClick:qe},[e.createVNode(n,{type:"close",size:"20",color:"#666"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"昵称"),e.withDirectives(e.createElementVNode("input",{class:"task-input","onUpdate:modelValue":l[8]||(l[8]=e=>J.value.nickname=e),placeholder:"请输入昵称...",maxlength:"20"},null,512),[[e.vModelText,J.value.nickname]])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"背景图片"),H.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"background-preview"},[e.createElementVNode("image",{src:H.value,class:"preview-image",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"remove-btn",onClick:Ze},[e.createVNode(n,{type:"close",size:"16",color:"#fff"})])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"choose-image-btn",onClick:Re},[e.createVNode(n,{type:"image",size:"24",color:"#667eea"}),e.createElementVNode("text",{class:"choose-text"},e.toDisplayString(H.value?"重新选择":"选择背景图片"),1)])]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:qe},"取消"),e.createElementVNode("button",{class:"confirm-btn",onClick:Ge,disabled:!J.value.nickname.trim()},"确认修改",8,["disabled"])])],2)])):e.createCommentVNode("",!0),C.value?(e.openBlock(),e.createElementBlock("view",{key:4,class:"modal-overlay delete-overlay",onClick:he},[e.createElementVNode("view",{class:"modal-content delete-modal",onClick:l[10]||(l[10]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"删除任务")]),e.createElementVNode("view",{class:"delete-message"},[e.createElementVNode("text",null,'将永久删除"'+e.toDisplayString(null==(u=x.value,o=s.value.find((e=>e.id===u)))?void 0:o.taskDescription)+'"。',1)]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:he},"取消"),e.createElementVNode("button",{class:"delete-btn",onClick:we},"删除")])])])):e.createCommentVNode("",!0),T.value?(e.openBlock(),e.createElementBlock("view",{key:5,class:"modal-overlay",onClick:ge},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content more-menu",{closing:S.value}]),onClick:l[11]||(l[11]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"menu-header"},[e.createElementVNode("view",{class:"menu-handle"}),e.createElementVNode("text",{class:"menu-title"},"列表选项"),e.createElementVNode("text",{class:"menu-done",onClick:ge},"完成")]),e.createElementVNode("view",{class:"menu-items"},[e.createElementVNode("view",{class:"menu-item",onClick:Ve},[e.createVNode(n,{type:"star",size:"20",color:"#333"}),e.createElementVNode("text",{class:"menu-text"},"收藏")]),e.createElementVNode("view",{class:"menu-item",onClick:Ne},[e.createVNode(n,{type:"bars",size:"20",color:"#333"}),e.createElementVNode("text",{class:"menu-text"},"统计")]),e.createElementVNode("view",{class:"menu-item",onClick:ye},[e.createVNode(n,{type:"chart",size:"20",color:"#333"}),e.createElementVNode("text",{class:"menu-text"},"图表")]),e.createElementVNode("view",{class:"menu-item",onClick:ke},[e.createVNode(n,{type:"list",size:"20",color:"#333"}),e.createElementVNode("text",{class:"menu-text"},"模板")])])],2)])):e.createCommentVNode("",!0),I.value?(e.openBlock(),e.createElementBlock("view",{key:6,class:"modal-overlay",onClick:Je},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content",{closing:D.value}]),onClick:l[14]||(l[14]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"消费"),e.createElementVNode("view",{class:"popup-close",onClick:Je},[e.createVNode(n,{type:"close",size:"20",color:"#666"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"消费金额"),e.withDirectives(e.createElementVNode("input",{class:"task-input","onUpdate:modelValue":l[12]||(l[12]=e=>A.value=e),type:"number",placeholder:"请输入消费金额...",focus:P.value,onBlur:l[13]||(l[13]=e=>P.value=!1),onInput:He},null,40,["focus"]),[[e.vModelText,A.value]])]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:Je},"取消"),e.createElementVNode("button",{class:"confirm-btn",onClick:We,disabled:!A.value||parseInt(A.value)<1},"消费",8,["disabled"])])],2)])):e.createCommentVNode("",!0)]);var u}}},[["__scopeId","data-v-80c914dc"]]),Y=M({__name:"register",setup(a){const l=e.ref(""),o=e.ref(""),n=e.ref(""),c=e.ref(""),i=e.ref(!1),r=e.ref(!1),u=e.ref(""),d=e.ref(""),p=e.ref(""),v=e.ref(""),m=()=>{i.value=!i.value},f=()=>{r.value=!r.value},h=e=>{n.value=e.detail.value,p.value&&(p.value="")},w=e=>{let t=e.detail.value;t=t.replace(/\D/g,""),t.length>11&&(t=t.slice(0,11)),l.value=t,u.value&&(u.value="")},g=e=>{let t=e.detail.value;t=t.replace(/[^a-zA-Z0-9_]/g,""),o.value=t,d.value&&(d.value=""),c.value&&v.value&&E()},V=e=>{let t=e.detail.value;t=t.replace(/[^a-zA-Z0-9_]/g,""),c.value=t,v.value&&(v.value="")},N=()=>{n.value&&n.value.trim().length<2?p.value="昵称格式为至少2个字符":p.value=""},y=()=>{l.value?/^1[3-9]\d{9}$/.test(l.value)?u.value="":u.value="手机号格式为1开头的11位数字":u.value=""},k=()=>{o.value?o.value.length<8?d.value="密码格式为至少8位字符":/^[a-zA-Z0-9_]+$/.test(o.value)?d.value="":d.value="密码格式只能包含字母数字和下划线":d.value=""},E=()=>{c.value&&c.value!==o.value?v.value="确认密码格式需与密码一致":v.value=""},_=e.computed((()=>/^1[3-9]\d{9}$/.test(l.value)&&o.value.length>=8&&/^[a-zA-Z0-9_]+$/.test(o.value)&&n.value.trim().length>=2&&c.value===o.value)),b=()=>{const e=o.value;return/^[a-zA-Z0-9_]*$/.test(e)?e.length<8?0:e.length<=10&&(/^[a-zA-Z]+$/.test(e)||/^\d+$/.test(e))?1:/[a-zA-Z]/.test(e)&&/\d/.test(e)&&/_/.test(e)?3:/[a-zA-Z]/.test(e)&&/\d/.test(e)?2:1:0},C=()=>{const e=b(),t=o.value;if(!/^[a-zA-Z0-9_]*$/.test(t))return"密码只能包含字母数字和下划线";if(t.length<8)return"密码至少8位";return["密码格式错误","密码强度：弱","密码强度：中","密码强度：强"][e]},x=async()=>{if(!_.value)return;if(n.value.trim().length<2)return void uni.showToast({title:"昵称至少需要2个字符",icon:"none"});if(!/^1[3-9]\d{9}$/.test(l.value))return void uni.showToast({title:"请输入正确的手机号格式",icon:"none"});if(o.value.length<8)return void uni.showToast({title:"密码至少需要8位",icon:"none"});if(!/^[a-zA-Z0-9_]+$/.test(o.value))return void uni.showToast({title:"密码只能包含字母数字和下划线",icon:"none"});if(o.value!==c.value)return void uni.showToast({title:"两次密码输入不一致",icon:"none"});const e=await s({phone:l.value,password:o.value,nickname:n.value});t("log","at pages/register/register.vue:366","注册结果:",e),200===e.code||"200"===e.code?(uni.showToast({title:"注册成功",icon:"success"}),uni.navigateTo({url:"/pages/index/index"})):uni.showToast({title:e.msg,icon:"none"})},T=()=>{uni.navigateTo({url:"/pages/index/index"})};return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"register-container"},[e.createElementVNode("view",{class:"register-card"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"logo"},[e.createElementVNode("text",{class:"logo-text"},"TODO+")]),e.createElementVNode("text",{class:"subtitle"},"创建您的账户")]),e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"昵称")]),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"请输入您的昵称","placeholder-class":"placeholder-style",onInput:h,onBlur:N},null,544),[[e.vModelText,n.value]])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:p.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(p.value),1)],2)]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"手机号")]),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>l.value=e),placeholder:"请输入手机号","placeholder-class":"placeholder-style",maxlength:"11",onInput:w,onBlur:y},null,544),[[e.vModelText,l.value]])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:u.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(u.value),1)],2)]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"密码")]),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:i.value?"text":"password","onUpdate:modelValue":a[2]||(a[2]=e=>o.value=e),placeholder:"请输入密码","placeholder-class":"placeholder-style",onInput:g,onBlur:k},null,40,["type"]),[[e.vModelDynamic,o.value]]),e.createElementVNode("view",{class:"eye-icon",onClick:m},[e.createElementVNode("text",{class:"iconfont"},e.toDisplayString(i.value?"👁️":"👁️‍🗨️"),1)])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:d.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(d.value),1)],2),e.createElementVNode("view",{class:e.normalizeClass(["password-strength",{show:o.value}])},[e.createElementVNode("text",{class:e.normalizeClass(["strength-text",["strength-weak","strength-weak","strength-medium","strength-strong"][b()]])},e.toDisplayString(C()),3)],2)]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"确认密码")]),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:r.value?"text":"password","onUpdate:modelValue":a[3]||(a[3]=e=>c.value=e),placeholder:"请再次输入密码","placeholder-class":"placeholder-style",onInput:V,onBlur:E},null,40,["type"]),[[e.vModelDynamic,c.value]]),e.createElementVNode("view",{class:"eye-icon",onClick:f},[e.createElementVNode("text",{class:"iconfont"},e.toDisplayString(r.value?"👁️":"👁️‍🗨️"),1)])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:v.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(v.value),1)],2)]),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("button",{class:e.normalizeClass(["register-btn",{"btn-disabled":!_.value}]),disabled:!_.value,onClick:x}," 注册 ",10,["disabled"])]),e.createElementVNode("view",{class:"footer-links"},[e.createElementVNode("text",{class:"link-text"},"已有账户？"),e.createElementVNode("text",{class:"link-btn",onClick:T},"立即登录")])])])]))}},[["__scopeId","data-v-8cc58d8c"]]),J=M({__name:"changePassword",setup(a){const l=e.ref(""),o=e.ref(""),n=e.ref(""),s=e.ref(""),c=e.ref(!1),u=e.ref(!1),d=e.ref(0),p=e.ref(null),v=e.ref(""),m=e.ref(""),f=e.ref(""),h=e.ref(""),w=()=>{c.value=!c.value},g=()=>{u.value=!u.value},V=e=>{let t=e.detail.value;t=t.replace(/\D/g,""),t.length>11&&(t=t.slice(0,11)),l.value=t,v.value&&(v.value="")},N=e=>{let t=e.detail.value;t=t.replace(/\D/g,""),t.length>6&&(t=t.slice(0,6)),o.value=t,m.value&&(m.value="")},y=e=>{let t=e.detail.value;t=t.replace(/[^a-zA-Z0-9_]/g,""),n.value=t,f.value&&(f.value=""),s.value&&h.value&&C()},k=e=>{let t=e.detail.value;t=t.replace(/[^a-zA-Z0-9_]/g,""),s.value=t,h.value&&(h.value="")},E=()=>{l.value?/^1[3-9]\d{9}$/.test(l.value)?v.value="":v.value="手机号格式为1开头的11位数字":v.value=""},_=()=>{o.value?/^\d{6}$/.test(o.value)?m.value="":m.value="验证码格式为6位数字":m.value=""},b=()=>{n.value?n.value.length<8?f.value="密码格式为至少8位字符":/^[a-zA-Z0-9_]+$/.test(n.value)?f.value="":f.value="密码格式只能包含字母数字和下划线":f.value=""},C=()=>{s.value&&s.value!==n.value?h.value="确认密码格式需与新密码一致":h.value=""},x=e.computed((()=>/^1[3-9]\d{9}$/.test(l.value)&&0===d.value)),T=e.computed((()=>d.value>0?`${d.value}秒`:"发送验证码")),S=e.computed((()=>/^1[3-9]\d{9}$/.test(l.value)&&/^\d{6}$/.test(o.value)&&n.value.length>=8&&/^[a-zA-Z0-9_]+$/.test(n.value)&&s.value===n.value)),z=()=>{const e=n.value;return/^[a-zA-Z0-9_]*$/.test(e)?e.length<8?0:e.length<=10&&(/^[a-zA-Z]+$/.test(e)||/^\d+$/.test(e))?1:/[a-zA-Z]/.test(e)&&/\d/.test(e)&&/_/.test(e)?3:/[a-zA-Z]/.test(e)&&/\d/.test(e)?2:1:0},B=()=>{const e=z(),t=n.value;if(!/^[a-zA-Z0-9_]*$/.test(t))return"密码只能包含字母数字和下划线";if(t.length<8)return"密码至少8位";return["密码格式错误","密码强度：弱","密码强度：中","密码强度：强"][e]},I=async()=>{x.value&&(/^1[3-9]\d{9}$/.test(l.value)?(t("log","at pages/changePassword/changePassword.vue:353","发送验证码到：",l.value),await r(l.value),uni.showToast({title:"验证码已发送",icon:"success"}),d.value=60,p.value=setInterval((()=>{d.value--,d.value<=0&&(clearInterval(p.value),p.value=null)}),1e3)):uni.showToast({title:"请输入正确的手机号格式",icon:"none"}))},D=async()=>{if(!S.value)return;if(!/^1[3-9]\d{9}$/.test(l.value))return void uni.showToast({title:"请输入正确的手机号格式",icon:"none"});if(!/^\d{6}$/.test(o.value))return void uni.showToast({title:"验证码必须是6位数字",icon:"none"});if(n.value.length<8)return void uni.showToast({title:"密码至少需要8位",icon:"none"});if(!/^[a-zA-Z0-9_]+$/.test(n.value))return void uni.showToast({title:"密码只能包含字母数字和下划线",icon:"none"});if(n.value!==s.value)return void uni.showToast({title:"两次密码输入不一致",icon:"none"});const e=await i({phone:l.value,password:n.value,code:o.value});t("log","at pages/changePassword/changePassword.vue:426","修改密码结果:",e),200===e.code||"200"===e.code?(uni.showToast({title:"密码修改成功",icon:"success"}),uni.navigateTo({url:"/pages/index/index"})):uni.showToast({title:e.msg,icon:"none"}),setTimeout((()=>{$()}),1500)},$=()=>{uni.navigateTo({url:"/pages/index/index"})};return e.onUnmounted((()=>{p.value&&clearInterval(p.value)})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"change-password-container"},[e.createElementVNode("view",{class:"change-password-card"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"logo"},[e.createElementVNode("text",{class:"logo-text"},"TODO+")]),e.createElementVNode("text",{class:"subtitle"},"重置您的密码")]),e.createElementVNode("view",{class:"form-container"},[e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"手机号")]),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:"number","onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),placeholder:"请输入手机号","placeholder-class":"placeholder-style",maxlength:"11",onInput:V,onBlur:E},null,544),[[e.vModelText,l.value]])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:v.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(v.value),1)],2)]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"验证码")]),e.createElementVNode("view",{class:"input-wrapper verification-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field verification-input",type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),placeholder:"请输入验证码","placeholder-class":"placeholder-style",maxlength:"6",onInput:N,onBlur:_},null,544),[[e.vModelText,o.value]]),e.createElementVNode("button",{class:e.normalizeClass(["send-code-btn",{"btn-disabled":!x.value}]),disabled:!x.value,onClick:I},e.toDisplayString(T.value),11,["disabled"])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:m.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(m.value),1)],2)]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"新密码")]),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:c.value?"text":"password","onUpdate:modelValue":a[2]||(a[2]=e=>n.value=e),placeholder:"请输入新密码","placeholder-class":"placeholder-style",onInput:y,onBlur:b},null,40,["type"]),[[e.vModelDynamic,n.value]]),e.createElementVNode("view",{class:"eye-icon",onClick:w},[e.createElementVNode("text",{class:"iconfont"},e.toDisplayString(c.value?"👁️":"👁️‍🗨️"),1)])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:f.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(f.value),1)],2),e.createElementVNode("view",{class:e.normalizeClass(["password-strength",{show:n.value}])},[e.createElementVNode("text",{class:e.normalizeClass(["strength-text",["strength-weak","strength-weak","strength-medium","strength-strong"][z()]])},e.toDisplayString(B()),3)],2)]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},[e.createElementVNode("text",{class:"label-text"},"确认新密码")]),e.createElementVNode("view",{class:"input-wrapper"},[e.withDirectives(e.createElementVNode("input",{class:"input-field",type:u.value?"text":"password","onUpdate:modelValue":a[3]||(a[3]=e=>s.value=e),placeholder:"请再次输入新密码","placeholder-class":"placeholder-style",onInput:k,onBlur:C},null,40,["type"]),[[e.vModelDynamic,s.value]]),e.createElementVNode("view",{class:"eye-icon",onClick:g},[e.createElementVNode("text",{class:"iconfont"},e.toDisplayString(u.value?"👁️":"👁️‍🗨️"),1)])]),e.createElementVNode("view",{class:e.normalizeClass(["error-tip",{show:h.value}])},[e.createElementVNode("text",{class:"error-text"},e.toDisplayString(h.value),1)],2)]),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("button",{class:e.normalizeClass(["change-password-btn",{"btn-disabled":!S.value}]),disabled:!S.value,onClick:D}," 确认修改 ",10,["disabled"])]),e.createElementVNode("view",{class:"footer-links"},[e.createElementVNode("text",{class:"link-text"},"记起密码了？"),e.createElementVNode("text",{class:"link-btn",onClick:$},"立即登录")])])])]))}},[["__scopeId","data-v-0400be6f"]]);const H=M({},[["render",function(t,a){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("h1",null,"统计")])}]]);const W=M({},[["render",function(t,a){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("h1",null,"账户")])}]]),K={__name:"test",setup:a=>(a,o)=>(e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("button",{onClick:o[0]||(o[0]=e=>(async()=>{t("log","at pages/test/test.vue:12",await l.get("/user/updatePasswordCode/13800138000"))})())},"发送")]))},Q=()=>l.get("/templateTask/queryList"),ee=e=>l.post("/templateTask/add",e),te=e=>l.post("/templateTask/upd",e),ae=e=>l.delete(`/templateTask/del/${e}`),le=M({__name:"template",setup(l){const o=$(),n=e.ref([]),s=e.ref(!1),c=e.ref({description:"",value:"1"}),i=e.ref({id:null,description:"",value:"1"}),r=e.ref(!1),u=e.ref(!1),d=e.ref(!1),p=e.ref(!1),v=e.ref(!1),m=e.ref(!1),f=e.ref({}),h=e.ref(0),w=e.ref(0),g=e.ref(null),V=e.ref(!1),N=e.ref(null),y=e.ref(!1),k=e.ref(!1),E=e.computed((()=>o.userInfo.backgroudImg||""));e.computed((()=>E.value&&!s.value));const _=()=>{uni.navigateTo({url:"/pages/home/home"})},b=()=>{y.value=!0},C=e=>{f.value[e]&&(f.value[e].translateX=0,f.value[e].showDelete=!1)},x=()=>{Object.keys(f.value).forEach((e=>{C(e)}))},T=()=>{x()},S=e=>{x(),N.value=e,V.value=!0},z=()=>{V.value=!1,N.value=null},B=async()=>{if(N.value){uni.showLoading({title:"删除中..."});try{const e=await ae(N.value);uni.hideLoading(),200===e.code||"200"===e.code?(uni.showToast({title:"模板已删除",icon:"success"}),await Y()):uni.showToast({title:e.message||"删除失败",icon:"none"})}catch(e){uni.hideLoading(),uni.showToast({title:"删除失败",icon:"none"}),t("error","at pages/template/template.vue:370","删除模板失败:",e)}finally{z()}}},I=()=>{k.value=!0,setTimeout((()=>{y.value=!1,k.value=!1}),300)},D=()=>{I(),setTimeout((()=>{uni.showToast({title:"排序功能待实现",icon:"none"})}),300)},A=()=>{r.value=!0,setTimeout((()=>{d.value=!0}),300)},P=()=>{u.value=!0,d.value=!1,setTimeout((()=>{r.value=!1,u.value=!1,c.value={description:"",value:"1"}}),300)},M=async()=>{if(c.value.description.trim()){uni.showLoading({title:"添加中..."});try{const e={desc:c.value.description.trim(),value:parseInt(c.value.value)||1},t=await ee(e);uni.hideLoading(),200===t.code||"200"===t.code?(P(),uni.showToast({title:"模板添加成功",icon:"success"}),Y()):uni.showToast({title:t.message||"添加失败",icon:"none"})}catch(e){uni.hideLoading(),uni.showToast({title:"添加失败",icon:"none"}),t("error","at pages/template/template.vue:468","添加模板失败:",e)}}else uni.showToast({title:"请输入任务描述",icon:"none"})},O=()=>{v.value=!0,m.value=!1,setTimeout((()=>{p.value=!1,v.value=!1,i.value={id:null,description:"",value:"1"}}),300)},j=async()=>{if(i.value.description.trim()){uni.showLoading({title:"修改中..."});try{const e={id:i.value.id,desc:i.value.description.trim(),value:parseInt(i.value.value)||1},t=await te(e);uni.hideLoading(),200===t.code||"200"===t.code?(O(),uni.showToast({title:"模板修改成功",icon:"success"}),Y()):uni.showToast({title:t.message||"修改失败",icon:"none"})}catch(e){uni.hideLoading(),uni.showToast({title:"修改失败",icon:"none"}),t("error","at pages/template/template.vue:552","修改模板失败:",e)}}else uni.showToast({title:"请输入任务描述",icon:"none"})},X=e=>{let t=e.detail.value||e.target.value;t=t.replace(/[^\d]/g,""),t&&parseInt(t)<1&&(t="1"),t||(t="1"),c.value.value=t},F=()=>{const e=parseInt(c.value.value)||1;c.value.value=(e+1).toString()},R=()=>{const e=parseInt(c.value.value)||1;e>1&&(c.value.value=(e-1).toString())},Z=e=>{let t=e.detail.value||e.target.value;t=t.replace(/[^\d]/g,""),t&&parseInt(t)<1&&(t="1"),t||(t="1"),i.value.value=t},q=()=>{const e=parseInt(i.value.value)||1;i.value.value=(e+1).toString()},G=()=>{const e=parseInt(i.value.value)||1;e>1&&(i.value.value=(e-1).toString())},Y=async()=>{try{const e=await Q();e&&"200"===e.code&&e.data&&(n.value=e.data)}catch(e){t("error","at pages/template/template.vue:616","获取模板列表失败:",e),uni.showToast({title:"获取模板列表失败",icon:"none"})}},J=()=>{s.value=!0,uni.showToast({title:"背景图片加载失败",icon:"none"})},H=()=>{s.value=!1};return e.onMounted((()=>{o.initUserInfo(),Y()})),(t,l)=>{var o;const s=a(e.resolveDynamicComponent("uni-icons"),U),x=a(e.resolveDynamicComponent("uni-card"),L);return e.openBlock(),e.createElementBlock("view",{class:"template-container"},[E.value?(e.openBlock(),e.createElementBlock("image",{key:0,src:E.value,class:"background-image",mode:"aspectFill",onError:J,onLoad:H},null,40,["src"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"nav-header"},[e.createElementVNode("view",{class:"nav-left"},[e.createVNode(s,{type:"back",size:"24",color:"#fff",onClick:_})]),e.createElementVNode("view",{class:"nav-center"},[e.createElementVNode("text",{class:"nav-title"},"任务模板")]),e.createElementVNode("view",{class:"nav-right"},[e.createVNode(s,{type:"more-filled",size:"24",color:"#fff",onClick:b})])]),e.createElementVNode("scroll-view",{class:"task-list","scroll-y":"true",onScroll:T},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,((t,a)=>(e.openBlock(),e.createBlock(x,{key:t.id,"is-shadow":!1,border:!1,margin:"8rpx 20rpx",class:"task-card task-swipe-container"},{default:e.withCtx((()=>{var a,l;return[e.createElementVNode("view",{class:"task-swipe-wrapper"},[e.createElementVNode("view",{class:"task-item",style:e.normalizeStyle({transform:`translateX(${(null==(a=f.value[t.id])?void 0:a.translateX)||0}rpx)`}),onTouchstart:e=>{return a=e,l=t.id,h.value=a.touches[0].clientX,w.value=a.touches[0].clientY,void(g.value=l);var a,l},onTouchmove:e=>((e,t)=>{if(g.value!==t)return;const a=e.touches[0].clientX,l=e.touches[0].clientY,o=a-h.value,n=l-w.value;if(!(Math.abs(n)>Math.abs(o))&&o<0){const e=Math.max(.5*o,-120);f.value[t]||(f.value[t]={}),f.value[t].translateX=e,f.value[t].showDelete=e<-30}})(e,t.id),onTouchend:e=>((e,t)=>{if(g.value!==t)return;const a=f.value[t];a&&(a.translateX<-60?S(t):a.translateX<-30?(a.translateX=-120,a.showDelete=!0):C(t),g.value=null)})(0,t.id)},[e.createElementVNode("view",{class:"template-icon"},[e.createVNode(s,{type:"list",size:"24",color:"#667eea"})]),e.createElementVNode("view",{class:"task-content",onClick:e=>((e,t)=>{t&&t.stopPropagation(),i.value={id:e.id,description:e.taskDescription,value:e.value?e.value.toString():"1"},p.value=!0,setTimeout((()=>{m.value=!0}),300)})(t,e)},[e.createElementVNode("text",{class:"task-description"},e.toDisplayString(t.taskDescription),1),t.value&&t.value>=1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"task-value"},[e.createVNode(s,{type:"wallet",size:"14",color:"#666"}),e.createElementVNode("text",{class:"value-text"},e.toDisplayString(t.value),1)])):e.createCommentVNode("",!0)],8,["onClick"]),e.createElementVNode("view",{class:"task-actions"},[e.createVNode(s,{type:"star",size:"24",color:"#C7C7CC"})])],44,["onTouchstart","onTouchmove","onTouchend"]),(null==(l=f.value[t.id])?void 0:l.showDelete)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"delete-action",onClick:e=>S(t.id)},[e.createVNode(s,{type:"trash",size:"24",color:"#fff"})],8,["onClick"])):e.createCommentVNode("",!0)])]})),_:2},1024)))),128))],32),e.createElementVNode("view",{class:"add-task-btn",onClick:A},[e.createVNode(s,{type:"plus",size:"20",color:"#fff"}),e.createElementVNode("text",{class:"add-btn-text"},"添加模板")]),r.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-overlay",onClick:P},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content",{closing:u.value}]),onClick:l[3]||(l[3]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"新建模板"),e.createElementVNode("view",{class:"popup-close",onClick:P},[e.createVNode(s,{type:"close",size:"20",color:"#666"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务描述"),e.withDirectives(e.createElementVNode("input",{class:"task-input","onUpdate:modelValue":l[0]||(l[0]=e=>c.value.description=e),placeholder:"请输入任务描述...",maxlength:"100",focus:d.value,onBlur:l[1]||(l[1]=e=>d.value=!1)},null,40,["focus"]),[[e.vModelText,c.value.description]])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务价值"),e.createElementVNode("view",{class:"number-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"task-input number-input","onUpdate:modelValue":l[2]||(l[2]=e=>c.value.value=e),type:"number",placeholder:"最小值为1",onInput:X},null,544),[[e.vModelText,c.value.value]]),e.createElementVNode("view",{class:"number-controls"},[e.createElementVNode("view",{class:"control-btn increase-btn",onClick:F},[e.createVNode(s,{type:"plus",size:"20",color:"#fff"})]),e.createElementVNode("view",{class:"control-btn decrease-btn",onClick:R},[e.createVNode(s,{type:"minus",size:"20",color:"#fff"})])])])]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:P},"取消"),e.createElementVNode("button",{class:"confirm-btn",onClick:M,disabled:!c.value.description.trim()},"确认添加",8,["disabled"])])],2)])):e.createCommentVNode("",!0),p.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal-overlay",onClick:O},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content",{closing:v.value}]),onClick:l[7]||(l[7]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"修改模板"),e.createElementVNode("view",{class:"popup-close",onClick:O},[e.createVNode(s,{type:"close",size:"20",color:"#666"})])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务描述"),e.withDirectives(e.createElementVNode("input",{class:"task-input","onUpdate:modelValue":l[4]||(l[4]=e=>i.value.description=e),placeholder:"请输入任务描述...",maxlength:"100",focus:m.value,onBlur:l[5]||(l[5]=e=>m.value=!1)},null,40,["focus"]),[[e.vModelText,i.value.description]])]),e.createElementVNode("view",{class:"input-group"},[e.createElementVNode("view",{class:"input-label"},"任务价值"),e.createElementVNode("view",{class:"number-input-container"},[e.withDirectives(e.createElementVNode("input",{class:"task-input number-input","onUpdate:modelValue":l[6]||(l[6]=e=>i.value.value=e),type:"number",placeholder:"最小值为1",onInput:Z},null,544),[[e.vModelText,i.value.value]]),e.createElementVNode("view",{class:"number-controls"},[e.createElementVNode("view",{class:"control-btn increase-btn",onClick:q},[e.createVNode(s,{type:"plus",size:"20",color:"#fff"})]),e.createElementVNode("view",{class:"control-btn decrease-btn",onClick:G},[e.createVNode(s,{type:"minus",size:"20",color:"#fff"})])])])]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:O},"取消"),e.createElementVNode("button",{class:"confirm-btn",onClick:j,disabled:!i.value.description.trim()},"确认修改",8,["disabled"])])],2)])):e.createCommentVNode("",!0),V.value?(e.openBlock(),e.createElementBlock("view",{key:3,class:"modal-overlay delete-overlay",onClick:z},[e.createElementVNode("view",{class:"modal-content delete-modal",onClick:l[8]||(l[8]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"popup-header"},[e.createElementVNode("text",{class:"popup-title"},"删除模板")]),e.createElementVNode("view",{class:"delete-message"},[e.createElementVNode("text",null,'将永久删除"'+e.toDisplayString(null==($=N.value,o=n.value.find((e=>e.id===$)))?void 0:o.taskDescription)+'"。',1)]),e.createElementVNode("view",{class:"popup-actions"},[e.createElementVNode("button",{class:"cancel-btn",onClick:z},"取消"),e.createElementVNode("button",{class:"delete-btn",onClick:B},"删除")])])])):e.createCommentVNode("",!0),y.value?(e.openBlock(),e.createElementBlock("view",{key:4,class:"modal-overlay",onClick:I},[e.createElementVNode("view",{class:e.normalizeClass(["modal-content more-menu",{closing:k.value}]),onClick:l[9]||(l[9]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"menu-header"},[e.createElementVNode("view",{class:"menu-handle"}),e.createElementVNode("text",{class:"menu-title"},"模板选项"),e.createElementVNode("text",{class:"menu-done",onClick:I},"完成")]),e.createElementVNode("view",{class:"menu-items"},[e.createElementVNode("view",{class:"menu-item",onClick:D},[e.createVNode(s,{type:"reload",size:"20",color:"#333"}),e.createElementVNode("text",{class:"menu-text"},"排序")])])],2)])):e.createCommentVNode("",!0)]);var $}}},[["__scopeId","data-v-c3b0d88e"]]);__definePage("pages/index/index",A),__definePage("pages/home/home",G),__definePage("pages/register/register",Y),__definePage("pages/changePassword/changePassword",J),__definePage("pages/statistics/statistics",H),__definePage("pages/account/account",W),__definePage("pages/test/test",K),__definePage("pages/template/template",le);const oe={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:ne,Vuex:se,Pinia:ce}=function(){const t=e.createVueApp(oe);return t.use(N()),{app:t,Pinia:D}}();uni.Vuex=se,uni.Pinia=ce,ne.provide("__globalStyles",__uniConfig.styles),ne._component.mpType="app",ne._component.render=()=>{},ne.mount("#app")}(Vue);
